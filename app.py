import streamlit as st
import matplotlib.pyplot as plt
import matplotlib.patches as patches
import matplotlib.font_manager as fm
import os
import urllib.request

# --- ãƒ•ã‚©ãƒ³ãƒˆè¨­å®š (å®‰å®šç‰ˆ) ---
def configure_font():
    font_filename = 'NotoSansJP-Regular.ttf'
    font_url = 'https://raw.githubusercontent.com/google/fonts/main/ofl/notosansjp/NotoSansJP-Regular.ttf'
    if not os.path.exists(font_filename):
        try:
            urllib.request.urlretrieve(font_url, font_filename)
        except Exception:
            pass
    if os.path.exists(font_filename):
        fm.fontManager.addfont(font_filename)
        plt.rcParams['font.family'] = 'Noto Sans JP'
    else:
        plt.rcParams['font.family'] = 'sans-serif'

configure_font()

# --- ãƒšãƒ¼ã‚¸è¨­å®š ---
st.set_page_config(page_title="Time Perception Analysis", layout="centered")

# --- ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´ (CSS) ---
st.markdown("""
<style>
    body { font-family: 'Helvetica Neue', Arial, sans-serif; }
    .disclaimer-box {
        background-color: #262730; color: #FAFAFA; padding: 15px;
        border-left: 5px solid #FF4B4B; border-radius: 4px; margin-bottom: 25px;
        font-size: 0.85rem; line-height: 1.5;
    }
    .disclaimer-title { font-weight: bold; color: #FF4B4B; display: block; margin-bottom: 5px; }
    .summary-box {
        background-color: rgba(255, 75, 75, 0.1); padding: 20px;
        border-radius: 10px; margin-bottom: 20px;
        border: 1px solid rgba(255, 75, 75, 0.2);
    }
    .summary-title { font-size: 1.2rem; font-weight: bold; color: inherit; margin-bottom: 10px; opacity: 0.9; }
    .summary-text { color: inherit; opacity: 0.8; }
    .book-ref { font-size: 0.8rem; color: #888; margin-top: 5px; font-style: italic; }
</style>
""", unsafe_allow_html=True)

# --- å…è²¬äº‹é … ---
st.markdown("""
<div class="disclaimer-box">
    <span class="disclaimer-title">ã€å…è²¬äº‹é …ãƒ»æœ¬ãƒ„ãƒ¼ãƒ«ã®ä½ç½®ã¥ã‘ã€‘</span>
    æœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€æ›¸ç±ã€YOUR TIME ãƒ¦ã‚¢ãƒ»ã‚¿ã‚¤ãƒ ã€ï¼ˆéˆ´æœ¨ ç¥ è‘—ï¼‰ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ç†è«–ã‚’å‚è€ƒã«ã€
    å¤šæ•°æ–‡çŒ®åŠã³ç‹¬è‡ªã®è¦‹è§£ã‚’ä»˜åŠ ã—ã€Dirbatoç¤¾å“¡å‘ã‘ã®æä¾›ã‚’ç›®çš„ã¨ã—ã¦æ§‹ç¯‰ã•ã‚ŒãŸ<strong>éå…¬å¼ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—</strong>ã§ã™ã€‚<br>
    è¨­å•ãƒ­ã‚¸ãƒƒã‚¯ã‚„è¨ºæ–­çµæœã¯æœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‘ã‘ã«ç‹¬è‡ªã«å†æ§‹æˆã•ã‚Œã¦ãŠã‚Šã€åŸè‘—ã®æ­£å¼ãªè¨ºæ–­ã¨ã¯ç•°ãªã‚Šã¾ã™ã€‚<br>
    ã¾ãŸã€æœ¬çµæœã¯åŒ»å­¦çš„ãªè¨ºæ–­ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ãªãã€å„äººã«ãƒãƒƒãƒã™ã‚‹å¯èƒ½æ€§ã®é«˜ã„æˆ¦ç•¥ä»®èª¬ã‚’æç¤ºã™ã‚‹ã‚‚ã®ã§ã™ã€‚
</div>
""", unsafe_allow_html=True)

# --- ã‚¿ã‚¤ãƒˆãƒ« ---
st.title("Time Perception Analysis")
st.caption("èªçŸ¥ç§‘å­¦ã¨ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãã€ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆã®ãŸã‚ã®æ™‚é–“æ„Ÿè¦šæœ€é©åŒ–")

# --- è¨­å•ãƒ‡ãƒ¼ã‚¿ ---
questions = {
    "expected_intensity": [
        "Q1. ä»Šã®è¡Œå‹•ãŒã€5å¹´å¾Œã‚„10å¹´å¾Œã®æœªæ¥ã«ã©ã†ç¹‹ãŒã‚‹ã‹ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹ã®ãŒå¾—æ„ã ã€‚",
        "Q2. ç›®ã®å‰ã®æ¥½ã—ã•ã‚ˆã‚Šã‚‚ã€å°†æ¥èµ·ã“ã‚Šã†ã‚‹ãƒªã‚¹ã‚¯ã®æ–¹ã«è‡ªç„¶ã¨æ„è­˜ãŒå‘ãã€‚",
        "Q3. å°†æ¥ã®å¹¸ç¦ã‚’é”æˆã™ã‚‹ãŸã‚ãªã‚‰ã€ç›®å…ˆã®å¹¸ç¦ã‚’çŠ ç‰²ã«ã™ã‚‹ã®ã«ã‚‚æŠµæŠ—ãŒãªã„ã€‚",
        "Q4. ã€Œä»Šã“ã‚Œã‚’ã‚„ã‚‰ãªã‘ã‚Œã°ã€å°†æ¥å¿…ãšå¾Œæ‚”ã™ã‚‹ã€ã¨ã„ã†è¦³ç‚¹ã§ç‰©äº‹ã‚’è¦‹ã‚‹ã“ã¨ãŒå¤šã„ã€‚",
        "Q5. æ¥½ã—ã„æ™‚é–“ã‚’éã”ã—ã¦ã„ã‚‹æœ€ä¸­ã§ã‚‚ã€ã¤ã„ã€Œæ¬¡ã«ã‚„ã‚‹ã¹ãã“ã¨ã€ã‚„ã€Œå¾Œã®äºˆå®šã€ã‚’è€ƒãˆã¦ã—ã¾ã†ã€‚"
    ],
    "expected_quantity": [
        "Q6. ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å¸³ã«ç©ºç™½ãŒã‚ã‚‹ã¨ã€ãã“ã«ä½•ã‹äºˆå®šã‚’å…¥ã‚ŒãŸããªã‚‹ã€ã‚ã‚‹ã„ã¯å…¥ã‚Œã¦ã—ã¾ã†ã€‚",
        "Q7. ã²ã¨ã¤ã®ä½œæ¥­ã‚’ã—ã¦ã„ã‚‹æœ€ä¸­ã«ã€ä»–ã®è¤‡æ•°ã®ã€Œã‚„ã‚‰ãªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ã€ãŒé ­ã«æµ®ã‹ã‚“ã§ãã‚‹ã€‚",
        "Q8. å…¨ã¦ã®ã‚¿ã‚¹ã‚¯ãŒã€Œä»Šã™ãã‚„ã‚‹ã¹ãé‡è¦äº‹é …ã€ã«è¦‹ãˆã¦ã—ã¾ã„ã€ã©ã‚Œã‚‚æ¨ã¦ãŒãŸã„ã¨æ„Ÿã˜ã‚‹ã€‚",
        "Q9. å¸¸ã«ã€Œæ™‚é–“ãŒè¶³ã‚Šãªã„ã€ã€Œä½•ã‹ã«è¿½ã‚ã‚Œã¦ã„ã‚‹ã€ã¨ã„ã†æ„Ÿè¦šãŒã‚ã‚‹ã€‚",
        "Q10. é•·æœŸã®ç›®æ¨™ã‚ˆã‚Šã‚‚ã€æ•°æ™‚é–“ã€œæ•°æ—¥ä»¥å†…ã®ã€Œã“ãªã™ã¹ãç”¨äº‹ã€ã§é ­ãŒã„ã£ã±ã„ã ã€‚"
    ],
    "recalled_accuracy": [
        "Q11. éå»ã®çµŒé¨“ã«åŸºã¥ãã€ã€Œæ„å¤–ã¨æ™‚é–“ãŒã‹ã‹ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€ã¨ãƒãƒƒãƒ•ã‚¡ï¼ˆä½™è£•ï¼‰ã‚’æŒãŸã›ã‚‹ç™–ãŒã‚ã‚‹ã€‚",
        "Q12. ã€Œè‡ªåˆ†ãªã‚‰ã‚‚ã£ã¨æ—©ãã§ãã‚‹ã¯ãšã ã€ã¨ã„ã†æœŸå¾…ã‚ˆã‚Šã‚‚ã€éå»ã®å®Ÿç¸¾ã‚¿ã‚¤ãƒ ã‚’ä¿¡é ¼ã™ã‚‹ã€‚",
        "Q13. è¨ˆç”»ã‚’ç«‹ã¦ã‚‹éš›ã«ã€éšœå®³ã‚„ä¸æ¸¬ã®äº‹æ…‹ã‚’å¿…ãšè€ƒãˆã‚‹ã€‚",
        "Q14. éå»ã«è‡ªåˆ†ãŒã©ã‚Œãã‚‰ã„ã®ã‚¹ãƒ”ãƒ¼ãƒ‰ã§ä½œæ¥­ã§ããŸã‹ã€å…·ä½“çš„ã«æ€ã„å‡ºã™ã“ã¨ãŒã§ãã‚‹ã€‚",
        "Q15. ä½œæ¥­ã‚’å§‹ã‚ã‚‹å‰ã«ã€éå»ã®é¡ä¼¼ã‚¿ã‚¹ã‚¯ã«ãŠã‘ã‚‹å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã€‚"
    ],
    "recalled_positivity": [
        "Q16. éå»ã®è‡ªåˆ†ã®åˆ¤æ–­ã‚„è¡Œå‹•ã¯ã€ä»Šã®è‡ªåˆ†ã«ã¨ã£ã¦ãƒ—ãƒ©ã‚¹ã«ãªã£ã¦ã„ã‚‹ã¨æ€ã†ã€‚",
        "Q17. ã€Œè‡ªåˆ†ã¯æ™‚é–“ã‚’æœ‰åŠ¹ã«ä½¿ã£ã¦ããŸäººé–“ã ã€ã¨ã„ã†è‡ªä¿¡ãŒã‚ã‚‹ã€‚",
        "Q18. éå»ã®å¤±æ•—ã‚’æ€ã„å‡ºã—ã¦ã‚‚ã€ã€Œã‚ã‚Œã¯ã‚ã‚Œã§è‰¯ã„çµŒé¨“ã ã£ãŸã€ã¨æ„å‘³ã¥ã‘ã§ãã‚‹ã€‚",
        "Q19. æœªçŸ¥ã®èª²é¡Œã«ç›´é¢ã—ã¦ã‚‚ã€ã€Œéå»ã«ãªã‚“ã¨ã‹ãªã£ãŸã‹ã‚‰ä»Šå›ã‚‚å¤§ä¸ˆå¤«ã ã‚ã†ã€ã¨æ€ãˆã‚‹ã€‚",
        "Q20. ä½œæ¥­å‰ã«ã€Œã“ã‚Œã¯è‡ªåˆ†ã«ã¯ç„¡ç†ã ã‚ã†ã€ã¨æ€ã†ã“ã¨ã¯ãªã„ã€‚"
    ]
}

# --- ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆ ---
options = ["å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„ (1)", "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„ (2)", "ã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„ (3)", "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹ (4)", "å®Œå…¨ã«å½“ã¦ã¯ã¾ã‚‹ (5)"]
option_values = {options[0]: 1, options[1]: 2, options[2]: 3, options[3]: 4, options[4]: 5}

with st.form("diagnosis_form"):
    st.header("Section 1: Future Perspective")
    st.info("æœªæ¥ã«å¯¾ã™ã‚‹ã€ŒäºˆæœŸã€ã®å‚¾å‘ã‚’åˆ†æã—ã¾ã™")
    
    st.subheader("Part A: Intensity (äºˆæœŸã®æ¿ƒã•)")
    q1_score = st.radio(questions["expected_intensity"][0], options, horizontal=True)
    q2_score = st.radio(questions["expected_intensity"][1], options, horizontal=True)
    q3_score = st.radio(questions["expected_intensity"][2], options, horizontal=True)
    q4_score = st.radio(questions["expected_intensity"][3], options, horizontal=True)
    q5_score = st.radio(questions["expected_intensity"][4], options, horizontal=True)
    
    st.markdown("---")
    st.subheader("Part B: Quantity (äºˆæœŸã®é‡)")
    q6_score = st.radio(questions["expected_quantity"][0], options, horizontal=True)
    q7_score = st.radio(questions["expected_quantity"][1], options, horizontal=True)
    q8_score = st.radio(questions["expected_quantity"][2], options, horizontal=True)
    q9_score = st.radio(questions["expected_quantity"][3], options, horizontal=True)
    q10_score = st.radio(questions["expected_quantity"][4], options, horizontal=True)

    st.header("Section 2: Past Perspective")
    st.info("éå»ã«å¯¾ã™ã‚‹ã€Œæƒ³èµ·ã€ã®å‚¾å‘ã‚’åˆ†æã—ã¾ã™")
    
    st.subheader("Part C: Accuracy (æƒ³èµ·ã®æ­£ç¢ºæ€§)")
    q11_score = st.radio(questions["recalled_accuracy"][0], options, horizontal=True)
    q12_score = st.radio(questions["recalled_accuracy"][1], options, horizontal=True)
    q13_score = st.radio(questions["recalled_accuracy"][2], options, horizontal=True)
    q14_score = st.radio(questions["recalled_accuracy"][3], options, horizontal=True)
    q15_score = st.radio(questions["recalled_accuracy"][4], options, horizontal=True)

    st.markdown("---")
    st.subheader("Part D: Positivity (æƒ³èµ·ã®è‚¯å®šåº¦)")
    q16_score = st.radio(questions["recalled_positivity"][0], options, horizontal=True)
    q17_score = st.radio(questions["recalled_positivity"][1], options, horizontal=True)
    q18_score = st.radio(questions["recalled_positivity"][2], options, horizontal=True)
    q19_score = st.radio(questions["recalled_positivity"][3], options, horizontal=True)
    q20_score = st.radio(questions["recalled_positivity"][4], options, horizontal=True)

    submitted = st.form_submit_button("Run Analysis (åˆ†æå®Ÿè¡Œ)", type="primary")

# --- é›†è¨ˆã¨çµæœè¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ ---
if submitted:
    s_exp_int = sum([option_values[x] for x in [q1_score, q2_score, q3_score, q4_score, q5_score]])
    s_exp_qty = sum([option_values[x] for x in [q6_score, q7_score, q8_score, q9_score, q10_score]])
    s_rec_acc = sum([option_values[x] for x in [q11_score, q12_score, q13_score, q14_score, q15_score]])
    s_rec_pos = sum([option_values[x] for x in [q16_score, q17_score, q18_score, q19_score, q20_score]])

    st.markdown("---")
    st.header("Analysis Result")

    # --- è¨ºæ–­ã‚µãƒãƒªã®åˆ¤å®š ---
    summary_future = []
    if s_exp_int <= 12: summary_future.append("äºˆæœŸãŒè–„ã„ (Weak)")
    if s_exp_int >= 13: summary_future.append("äºˆæœŸãŒæ¿ƒã„ (Strong)")
    if s_exp_qty >= 13: summary_future.append("äºˆæœŸãŒå¤šã„ (High)")
    if s_exp_qty <= 12: summary_future.append("äºˆæœŸãŒå°‘ãªã„ (Low)")

    summary_past = []
    if s_rec_acc <= 12: summary_past.append("è¦‹ç©ã‚‚ã‚ŠãŒç”˜ã„ (Low Accuracy)")
    if s_rec_acc >= 13: summary_past.append("è¦‹ç©ã‚‚ã‚ŠãŒæ­£ç¢º (High Accuracy)")
    if s_rec_pos <= 12: summary_past.append("å¦å®šçš„ (Negative)")
    if s_rec_pos >= 13: summary_past.append("è‚¯å®šçš„ (Positive)")

    st.markdown(f"""
    <div class="summary-box">
        <div class="summary-title">ğŸ“Š è¨ºæ–­ã‚µãƒãƒª</div>
        <p class="summary-text"><strong>Future Perspective (æœªæ¥):</strong> {', '.join(summary_future)}</p>
        <p class="summary-text"><strong>Past Perspective (éå»):</strong> {', '.join(summary_past)}</p>
    </div>
    """, unsafe_allow_html=True)

    # --- ãƒãƒ£ãƒ¼ãƒˆæç”» ---
    def plot_matrix(x_score, y_score, x_label, y_label, title, x_min, x_max, y_min, y_max):
        fig, ax = plt.subplots(figsize=(6, 6))
        ax.set_xlim(0, 25)
        ax.set_ylim(0, 25)
        ax.axvline(x=12.5, color='#BDC3C7', linestyle='--', alpha=0.7)
        ax.axhline(y=12.5, color='#BDC3C7', linestyle='--', alpha=0.7)
        ax.scatter(x_score, y_score, color='#E74C3C', s=250, zorder=5, edgecolors='white', linewidth=2)
        ax.set_xlabel(x_label, fontsize=11, color='#34495E')
        ax.set_ylabel(y_label, fontsize=11, color='#34495E')
        ax.set_title(title, fontsize=14, fontweight='bold', color='#2C3E50', pad=15)
        plt.text(1, 12.5, y_min, ha='left', va='center', rotation=90, color='#95A5A6', fontsize=10)
        plt.text(1, 13, y_max, ha='left', va='center', rotation=90, color='#95A5A6', fontsize=10)
        plt.text(12.5, 1, x_min, ha='center', va='bottom', color='#95A5A6', fontsize=10)
        plt.text(13, 1, x_max, ha='center', va='bottom', color='#95A5A6', fontsize=10)
        rect = patches.Rectangle((12.5, 12.5), 12.5, 12.5, linewidth=0, edgecolor='none', facecolor='#F0F2F6', alpha=0.5)
        ax.add_patch(rect)
        st.pyplot(fig)

    col1, col2 = st.columns(2)
    with col1:
        st.markdown(f"**Future Perspective (äºˆæœŸ)**")
        plot_matrix(s_exp_qty, s_exp_int, "Quantity (Expected)", "Intensity (Expected)", "Future Matrix", "Low", "High", "Weak", "Strong")
    with col2:
        st.markdown(f"**Past Perspective (æƒ³èµ·)**")
        plot_matrix(s_rec_pos, s_rec_acc, "Positivity (Recalled)", "Accuracy (Recalled)", "Past Matrix", "Negative", "Positive", "Error", "Correct")

    # --- Strategic Recommendations Logic ---
    st.markdown("---")
    st.header("Strategic Recommendations")
    st.info("ã‚ãªãŸã®æ™‚é–“æ„Ÿè¦šç‰¹æ€§ã«åŸºã¥ã„ã¦å°ãå‡ºã•ã‚ŒãŸæœ€é©è§£ã‚’æç¤ºã—ã¾ã™ã€‚")

    recommendations = []

    # 1. äºˆæœŸãŒè–„ã™ãã‚‹ (Weak Expectation)
    if s_exp_int <= 12:
        recommendations.append({
            "title": "Strategy: Future Connection (æœªæ¥ã¨ã®æ¥ç¶šå¼·åŒ–)",
            "reason": "æœªæ¥ã®å ±é…¬ã‚’ãƒªã‚¢ãƒ«ã«æ„Ÿã˜ã‚‰ã‚Œãšã€ç›®å…ˆã®èª˜æƒ‘ï¼ˆSNSã‚„ç°¡å˜ãªã‚¿ã‚¹ã‚¯ï¼‰ã«æµã•ã‚Œã‚„ã™ã„çŠ¶æ…‹ã§ã™ã€‚ã“ã‚Œã¯ã€Œæ€ æƒ°ã€ã§ã¯ãªãã€è„³ãŒé ãã®æœªæ¥ã‚’èªè­˜ã§ãã¦ã„ãªã„ã€Œè¿‘è¦–çœ¼çš„ãªçŠ¶æ…‹ã€ã§ã™ã€‚å¯¾ç­–ã¯ã€æœªæ¥ã‚’å¼·åˆ¶çš„ã«ã€Œä»Šã€ã«å¼•ãå¯„ã›ã‚‹ã“ã¨ã§ã™ã€‚",
            "methods": [
                {
                    "name": "ã‚¢ãƒ³ãƒ‘ãƒƒã‚­ãƒ³ã‚°ï¼ˆã‚¿ã‚¹ã‚¯ã®æ¥µå°åˆ†è§£ï¼‰",
                    "how_to": "æ°—ã®é€²ã¾ãªã„å¤§ããªã‚¿ã‚¹ã‚¯ï¼ˆä¾‹ï¼šä¼ç”»æ›¸ä½œæˆï¼‰ã‚’ã€ã“ã‚Œä»¥ä¸Šåˆ†è§£ã§ããªã„ãƒ¬ãƒ™ãƒ«ï¼ˆä¾‹ï¼šãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ä¸€è¡Œç›®ã‚’æ›¸ãã€ç”»åƒã‚’æ¤œç´¢ã™ã‚‹ï¼‰ã¾ã§ç´°ã‹ãåˆ†è§£ã—ã€ãƒªã‚¹ãƒˆåŒ–ã—ã¦ãã ã•ã„ã€‚",
                    "tips": "è„³ã¯ã€Œå¤§ããªå¡Šã€ã‚’è¦‹ã‚‹ã¨ææ€–ã‚„é¢å€’ã•ã‚’æ„Ÿã˜ã¦ãƒ•ãƒªãƒ¼ã‚ºã—ã¾ã™ã€‚ã—ã‹ã—ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ã ã‘ãªã‚‰æŠµæŠ—ãªãå®Ÿè¡Œã§ãã¾ã™ã€‚æœ€åˆã®ãƒ‰ãƒŸãƒã‚’å€’ã™ã“ã¨ã ã‘ã«é›†ä¸­ã™ã‚Œã°ã€å¾Œã¯ä½œæ¥­èˆˆå¥®ã«ã‚ˆã‚Šè‡ªå‹•çš„ã«é€²ã¿ã¾ã™ã€‚"
                },
                {
                    "name": "ã‚¿ã‚¤ãƒ ãƒœã‚¯ã‚·ãƒ³ã‚°ï¼ˆæ™‚é–“ã®ç®±è©°ã‚ï¼‰",
                    "how_to": "ToDoãƒªã‚¹ãƒˆã®ä½¿ç”¨ã‚’ã‚„ã‚ã€å…¨ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸Šã®ã€Œäºˆå®šã€ã¨ã—ã¦ãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚ã€Œä¼ç”»æ›¸ä½œæˆã€ã§ã¯ãªãã€Œ14:00ã€œ14:30 ä¼ç”»æ›¸ã®ç›®æ¬¡ã‚’ä½œã‚‹ã€ã¨ã€é–‹å§‹ã¨çµ‚äº†æ™‚åˆ»ã‚’æ˜ç¢ºã«äºˆç´„ã—ã¾ã™ã€‚",
                    "tips": "ã€Œã„ã¤ã‹ã‚„ã‚‹ã€ã¨ã„ã†ã‚¿ã‚¹ã‚¯ã¯ã€è„³å†…ã§æ°¸é ã«å…ˆé€ã‚Šã•ã‚Œã¾ã™ã€‚ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨ã„ã†ã€Œç‰©ç†çš„ãªç®±ã€ã«å…¥ã‚Œã‚‹ã“ã¨ã§ã€è„³ã¯ãã‚Œã‚’ã€Œä¼šè­°ã€ã¨åŒã˜ãã‚‰ã„å¼·åˆ¶åŠ›ã®ã‚ã‚‹æ±ºå®šäº‹é …ã¨ã—ã¦èªè­˜ã—å§‹ã‚ã¾ã™ã€‚"
                },
                {
                    "name": "é€†ç®—è¨­è¨ˆã¨ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³è¨­å®š",
                    "how_to": "3å¹´å¾Œã®ç†æƒ³çŠ¶æ…‹ã‹ã‚‰é€†ç®—ã—ã€ã€Œ1å¹´å¾Œã€ã€Œ3ãƒ¶æœˆå¾Œã€ã€Œ1é€±é–“å¾Œã€ãã—ã¦ã€Œä»Šæ—¥ã€ã‚„ã‚‹ã¹ãã“ã¨ã¾ã§å› æ•°åˆ†è§£ã—ã¦ãã ã•ã„ã€‚ã€Œä»Šæ—¥3ä¸‡å††ç¨¼ãã“ã¨ãŒã€3å¹´å¾Œã®å¹´å1000ä¸‡ã«ç›´çµã™ã‚‹ã€ã¨ã„ã†ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½œã‚Šã¾ã™ã€‚",
                    "tips": "æœªæ¥ãŒé ã™ãã‚‹ã¨ã€ä»Šã®è¡Œå‹•ã®ä¾¡å€¤ãŒã‚¼ãƒ­ã«è¦‹ãˆã¦ã—ã¾ã„ã¾ã™ã€‚é ã„æœªæ¥ã¨ç¾åœ¨ã®è¡Œå‹•ã‚’è«–ç†ã®é–ã§ç¹‹ãã“ã¨ã§ã€ä»Šã®åœ°å‘³ãªä½œæ¥­ã«ã€Œæœªæ¥ã®ä¾¡å€¤ã€ã‚’ä»˜ä¸ã—ã€ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¶­æŒã§ãã¾ã™ã€‚"
                },
                {
                    "name": "3ã¤ã®ç†ï¼ˆã“ã¨ã‚ã‚Šï¼‰ã¨ã®å¯¾è©±",
                    "how_to": "é€±ã«ä¸€åº¦ã€5åˆ†é–“ã§è‰¯ã„ã®ã§ã€Œè‡ªåˆ†ã¯ã„ãšã‚Œæ­»ã¬ã€ã€Œæœ€çµ‚çš„ã«ã¯ä¸€äººã§ã‚ã‚‹ã€ã€Œäººç”Ÿã®è²¬ä»»ã¯è‡ªåˆ†ã«ã‚ã‚‹ã€ã¨ã„ã†äº‹å®Ÿã«ã¤ã„ã¦é™ã‹ã«æ€è€ƒã™ã‚‹æ™‚é–“ã‚’å–ã£ã¦ãã ã•ã„ã€‚",
                    "tips": "ãƒã‚¬ãƒ†ã‚£ãƒ–ãªæ€è€ƒã§ã¯ãªãã€äººç”Ÿã®æœ‰é™æ€§ã‚’å¼·çƒˆã«èªè­˜ã™ã‚‹ãŸã‚ã®ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ã€Œæ™‚é–“ã¯ç„¡é™ã«ã‚ã‚‹ã€ã¨ã„ã†éŒ¯è¦šï¼ˆç¾åœ¨ãƒã‚¤ã‚¢ã‚¹ï¼‰ã‚’è§£é™¤ã—ã€æœ¬å½“ã«é‡è¦ãªã“ã¨ã«ç€æ‰‹ã™ã‚‹ç·Šæ€¥æ€§ã‚’è„³ã«æ¤ãˆä»˜ã‘ã¾ã™ã€‚"
                }
            ]
        })

    # 2. äºˆæœŸãŒæ¿ƒã™ãã‚‹ (Strong Expectation)
    if s_exp_int >= 13:
        recommendations.append({
            "title": "Strategy: Anxiety Mitigation (äºˆæœŸä¸å®‰ã®ç·©å’Œ)",
            "reason": "æœªæ¥ã®ãƒªã‚¹ã‚¯ã‚„è²¬ä»»ã‚’éå‰°ã«é‡ãè¦‹ç©ã‚‚ã£ã¦ãŠã‚Šã€ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã§å‹•ã‘ãªããªã£ãŸã‚Šã€ç‡ƒãˆå°½ãã‚‹ï¼ˆãƒãƒ¼ãƒ³ã‚¢ã‚¦ãƒˆï¼‰ãƒªã‚¹ã‚¯ãŒé«˜ã„çŠ¶æ…‹ã§ã™ã€‚çœŸé¢ç›®ã•ãŒè£ç›®ã«å‡ºã¦ã„ã¾ã™ã€‚ã€Œä¼‘ã‚€æŠ€è¡“ã€ã¨ã€Œå®Œç’§ä¸»ç¾©ã®æ‰‹æ”¾ã—ã€ãŒå‡¦æ–¹ç®‹ã§ã™ã€‚",
            "methods": [
                {
                    "name": "ãŸã‚æ¯æˆ¦ç•¥ï¼ˆå‘¼å¸ã«ã‚ˆã‚‹ãƒªã‚»ãƒƒãƒˆï¼‰",
                    "how_to": "ãƒ‡ã‚¹ã‚¯ãƒ¯ãƒ¼ã‚¯ä¸­ã€æ„è­˜çš„ã«æ·±ãæ¯ã‚’å¸ã„ã€é•·ãã€Œã¯ãã€œã€ã¨éŸ³ãŒå‡ºã‚‹ãã‚‰ã„æ¯ã‚’åãå‡ºã™ã€ŒãŸã‚æ¯ã€ã‚’ã€1æ—¥10å›ä»¥ä¸Šè¡Œã£ã¦ãã ã•ã„ã€‚",
                    "tips": "ãƒˆãƒƒãƒ—5%ç¤¾å“¡ã«å…±é€šã™ã‚‹ç¿’æ…£ã§ã™ã€‚ã‚ãªãŸã®è„³ã¯å¸¸ã«äº¤æ„Ÿç¥çµŒï¼ˆç·Šå¼µï¼‰ãŒå„ªä½ã«ãªã£ã¦ã„ã¾ã™ã€‚ãŸã‚æ¯ã¯å‰¯äº¤æ„Ÿç¥çµŒï¼ˆãƒªãƒ©ãƒƒã‚¯ã‚¹ï¼‰ã‚’å¼·åˆ¶çš„ã«èµ·å‹•ã•ã›ã‚‹ã‚¹ã‚¤ãƒƒãƒã¨ãªã‚Šã€éå‰°ãªç·Šå¼µã‚’ç‰©ç†çš„ã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚"
                },
                {
                    "name": "8å‰²å®Œæˆä¸»ç¾©",
                    "how_to": "æœ€åˆã‹ã‚‰100ç‚¹ã‚’ç›®æŒ‡ã•ãšã€ã¾ãšã¯ã€Œ2å‰²ã®æ™‚é–“ã§80ç‚¹ã®å‡ºæ¥ã€ã‚’ç›®æŒ‡ã—ã¦ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã—ã¦ãã ã•ã„ã€‚ã€Œã¨ã‚Šã‚ãˆãš8å‰²ã§æå‡ºã—ã¾ã™ã€ã¨å®£è¨€ã—ã¦ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã‚‚ã‚‰ã†ãƒ•ãƒ­ãƒ¼ã«å¤‰ãˆã¾ã™ã€‚",
                    "tips": "æ™‚é–“ã‚’ã‹ã‘ã¦100ç‚¹ã‚’ç›®æŒ‡ã—ã¦ã‚‚ã€æ–¹å‘æ€§ãŒé•ãˆã°å…¨ã¦ç„¡é§„ã«ãªã‚Šã¾ã™ã€‚ãƒ‘ãƒ¬ãƒ¼ãƒˆã®æ³•å‰‡ï¼ˆ80:20ï¼‰ã‚’æ„è­˜ã—ã€ç´ æ—©ã80ç‚¹ã‚’ä½œã‚‹ã‚µã‚¤ã‚¯ãƒ«ã‚’å›ã™æ–¹ãŒã€çµæœçš„ã«é«˜å“è³ªã§ã‚¹ãƒˆãƒ¬ã‚¹ã®å°‘ãªã„æˆæœç‰©ã«ãªã‚Šã¾ã™ã€‚"
                },
                {
                    "name": "ãƒ—ãƒ¬ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆï¼ˆå¼·åˆ¶çš„ãªä¼‘æš‡ï¼‰",
                    "how_to": "3ãƒ¶æœˆä»¥ä¸Šå…ˆã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã€èˆªç©ºåˆ¸ã‚„ãƒ›ãƒ†ãƒ«ã®äºˆç´„ãªã©ã€Œã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ã¨é‡‘éŠ­çš„ç—›ã¿ã‚’ä¼´ã†ä¼‘æš‡ã€ã‚’å…ˆã«å…¥ã‚Œã¦ã—ã¾ã£ã¦ãã ã•ã„ã€‚",
                    "tips": "ã‚ãªãŸã®æ„å¿—åŠ›ã§ã¯ä¼‘ã‚€ã“ã¨ã¯ä¸å¯èƒ½ã§ã™ã€‚ã€Œä»•äº‹ãŒè½ã¡ç€ã„ãŸã‚‰ä¼‘ã‚€ã€ã¨ã„ã†æ—¥ã¯æ°¸é ã«æ¥ã¾ã›ã‚“ã€‚ç’°å¢ƒå´ã‹ã‚‰å¼·åˆ¶çš„ã«ä¼‘ã¿ã‚’ä½œã‚Šå‡ºã—ã€ãã“ã«å‘ã‘ã¦ä»•äº‹ã‚’èª¿æ•´ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã¸ã®è»¢æ›ãŒå¿…è¦ã§ã™ã€‚"
                },
                {
                    "name": "æ©Ÿèƒ½çš„ã‚¢ãƒªãƒã‚¤ï¼ˆä¼‘æ¯ã®æ­£å½“åŒ–ï¼‰",
                    "how_to": "ä¼‘ã‚€ã“ã¨ã«ç½ªæ‚ªæ„Ÿã‚’æ„Ÿã˜ã‚‹ãªã‚‰ã€ã€Œã“ã‚Œã¯è‰¯ã„ä»•äº‹ã‚’ã™ã‚‹ãŸã‚ã®è„³ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ¥­å‹™ã§ã‚ã‚‹ã€ã¨å®šç¾©ã—ç›´ã—ã¦ãã ã•ã„ã€‚ã€Œã‚µãƒœã‚Šã€ã§ã¯ãªãã€Œæ¥­å‹™ã®ä¸€ç’°ã€ã¨ã—ã¦ä¼‘æ¯ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«çµ„ã¿è¾¼ã¿ã¾ã™ã€‚",
                    "tips": "ãƒ—ãƒ­ã®ã‚¢ã‚¹ãƒªãƒ¼ãƒˆãŒä¼‘æ¯ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ä¸€éƒ¨ã¨æ‰ãˆã‚‹ã®ã¨åŒã˜ã§ã™ã€‚è„³ã‚’ã‚¢ã‚¤ãƒ‰ãƒªãƒ³ã‚°çŠ¶æ…‹ã«ã™ã‚‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ»ãƒ¢ãƒ¼ãƒ‰ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ´»æ€§åŒ–ã•ã›ã‚‹ï¼‰ã“ã¨ã§ã€å‰µé€ æ€§ã‚„å•é¡Œè§£æ±ºèƒ½åŠ›ãŒå›å¾©ã—ã¾ã™ã€‚"
                }
            ]
        })

    # 3. äºˆæœŸãŒå¤šã™ãã‚‹ (High Quantity)
    if s_exp_qty >= 13:
        recommendations.append({
            "title": "Strategy: Bandwidth Optimization (è„³å†…å¸¯åŸŸã®è§£æ”¾)",
            "reason": "ã‚„ã‚ŠãŸã„ã“ã¨ãƒ»ã‚„ã‚‹ã¹ãã“ã¨ãŒå¤šã™ãã¦ã€è„³ã®å‡¦ç†èƒ½åŠ›ï¼ˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªï¼‰ãŒãƒ‘ãƒ³ã‚¯ã—ã¦ã„ã¾ã™ã€‚å¸¸ã«ä½•ã‹ã«è¿½ã‚ã‚Œã¦ã„ã‚‹æ„Ÿè¦šãŒã‚ã‚Šã€ä¸€ã¤ä¸€ã¤ã®è³ªãŒä½ä¸‹ã—ã¦ã„ã¾ã™ã€‚å‹‡æ°—ã‚’æŒã£ã¦ã€Œæ¨ã¦ã‚‹ã€ã“ã¨ãŒå”¯ä¸€ã®è§£æ±ºç­–ã§ã™ã€‚",
            "methods": [
                {
                    "name": "1åˆ†ãƒ«ãƒ¼ãƒ«ï¼ˆæ±ºæ–­ã®é«˜é€ŸåŒ–ï¼‰",
                    "how_to": "ãƒ©ãƒ³ãƒã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚„æ—¥ç”¨å“ã®è³¼å…¥ãªã©ã€å°ã•ãªé¸æŠã«è¿·ã£ãŸã‚‰ã€Œ1åˆ†ä»¥å†…ã€ã«æ±ºã‚ã‚‹ã¨ãƒ«ãƒ¼ãƒ«åŒ–ã—ã¦ãã ã•ã„ã€‚æ±ºã¾ã‚‰ãªã‘ã‚Œã°ã‚³ã‚¤ãƒ³æŠ•ã’ã§æ±ºã‚ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚",
                    "tips": "è¿·ã£ã¦ã„ã‚‹æ™‚é–“ã¯ä½•ã‚‚ç”Ÿã¿å‡ºã—ã¾ã›ã‚“ã€‚ã¾ãŸã€å°ã•ãªæ±ºæ–­ã§ã‚‚è„³ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆã‚¦ã‚£ãƒ«ãƒ‘ãƒ¯ãƒ¼ï¼‰ã‚’æ¶ˆè²»ã—ã¾ã™ã€‚ã©ã†ã§ã‚‚ã„ã„æ±ºæ–­ã‚’æ©Ÿæ¢°çš„ã«å‡¦ç†ã™ã‚‹ã“ã¨ã§ã€é‡è¦ãªä»•äº‹ã«ä½¿ã†ãŸã‚ã®è„³ã®ä½“åŠ›ã‚’æ¸©å­˜ã—ã¦ãã ã•ã„ã€‚"
                },
                {
                    "name": "é€±æ¬¡3ã¤ã®ã€Œæ–­ã‚‹å‹‡æ°—ã€",
                    "how_to": "æ¯é€±ã€ã€Œã‚„ã‚‰ãªãã¦ã„ã„ã“ã¨ã€ã‚„ã€Œæ°—ã®é€²ã¾ãªã„èª˜ã„ã€ã‚’3ã¤ç‰¹å®šã—ã€æ–­ã‚‹ã‹ã€å§”è­²ã™ã‚‹ã‹ã€ç„¡è¦–ã—ã¦ãã ã•ã„ã€‚ã€Œè‡ªåˆ†ãŒã‚„ã‚‹å¿…ç„¶æ€§ãŒã‚ã‚‹ã‹ï¼Ÿã€ã€Œé•·æœŸçš„ä¾¡å€¤ãŒã‚ã‚‹ã‹ï¼Ÿã€ã®2ç‚¹ã§ã‚¸ãƒ£ãƒƒã‚¸ã—ã¾ã™ã€‚",
                    "tips": "å…¨ã¦ã®ãƒœãƒ¼ãƒ«ã‚’æ‰“ã¡è¿”ãã†ã¨ã—ãªã„ã§ãã ã•ã„ã€‚ã‚ãªãŸãŒãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«ãªã‚Šã€å…¨ä½“ã®é€²è¡Œã‚’é…ã‚‰ã›ã¦ã„ã¾ã™ã€‚æ–­ã‚‹ã“ã¨ã¯ã€ç›¸æ‰‹ã«å¯¾ã™ã‚‹ä¸ç¾©ç†ã§ã¯ãªãã€è‡ªåˆ†ã®æœ¬æ¥ã®å½¹å‰²ã«å¯¾ã™ã‚‹èª å®Ÿã•ã®è¨¼æ˜ã§ã™ã€‚"
                },
                {
                    "name": "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å„ªå…ˆä¸»ç¾©ï¼ˆNo ToDoï¼‰",
                    "how_to": "ToDoãƒªã‚¹ãƒˆã‚’ä½¿ã†ã®ã‚’ã‚„ã‚ã€å…¨ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«å…¥ã‚Œã¦ãã ã•ã„ã€‚ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æ ã«å…¥ã‚Šåˆ‡ã‚‰ãªã„ã‚¿ã‚¹ã‚¯ã¯ã€ã€Œç‰©ç†çš„ã«ä¸å¯èƒ½ã€ã¨ã—ã¦è«¦ã‚ã‚‹ã‹ã€æ¥é€±ä»¥é™ã«å›ã—ã¾ã™ã€‚",
                    "tips": "ToDoãƒªã‚¹ãƒˆã¯ç„¡é™ã«å¢—ãˆã¾ã™ãŒã€æ™‚é–“ã¯æœ‰é™ã§ã™ã€‚ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨ã„ã†ã€Œæœ‰é™ã®ç®±ã€ã‚’ä½¿ã†ã“ã¨ã§ã€å¼·åˆ¶çš„ã«å„ªå…ˆé †ä½ä»˜ã‘ã‚’è¿«ã‚‰ã‚Œã€ã€Œã‚„ã‚‰ãªã„ã“ã¨ã€ã‚’å¯è¦–åŒ–ã§ãã¾ã™ã€‚"
                }
            ]
        })

    # 4. äºˆæœŸãŒå°‘ãªã™ãã‚‹ (Low Quantity)
    if s_exp_qty <= 12:
        recommendations.append({
            "title": "Strategy: Focus Maximization (é›†ä¸­ã®æœ€å¤§åŒ–)",
            "reason": "äºˆæœŸã®é‡ãŒå°‘ãªãã€ç›®ã®å‰ã®ã“ã¨ã«æ²¡é ­ã§ãã¦ã„ã‚‹è‰¯å¥½ãªçŠ¶æ…‹ã§ã™ã€‚ã“ã®ã€Œä¸€ç‚¹é›†ä¸­ã€ã®æ‰èƒ½ã‚’æ´»ã‹ã—ã€æˆæœã®è³ªã‚’æ¥µé™ã¾ã§é«˜ã‚ã‚‹ãŸã‚ã®ã€Œç’°å¢ƒè¨­å®šã€ã¨ã€Œãƒªã‚ºãƒ ä½œã‚Šã€ã«æ³¨åŠ›ã—ã¦ãã ã•ã„ã€‚",
            "methods": [
                {
                    "name": "è„³ã®ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¿ã‚¤ãƒ æ´»ç”¨",
                    "how_to": "èµ·åºŠå¾Œ2ã€œ3æ™‚é–“ï¼ˆè„³ãŒæœ€ã‚‚ãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãªçŠ¶æ…‹ï¼‰ã‚’ã€æœ€ã‚‚é‡è¦ãªã€Œæ€è€ƒç³»ã‚¿ã‚¹ã‚¯ï¼ˆä¼ç”»ã€åŸ·ç­†ã€æˆ¦ç•¥ç­–å®šï¼‰ã€ã«å……ã¦ã¦ãã ã•ã„ã€‚ã“ã®æ™‚é–“ã¯ãƒ¡ãƒ¼ãƒ«ã‚„ãƒãƒ£ãƒƒãƒˆã‚’ä¸€åˆ‡è¦‹ãªã„ã§ãã ã•ã„ã€‚",
                    "tips": "æœã®1æ™‚é–“ã¯ã€å¤œã®3æ™‚é–“ã«åŒ¹æ•µã™ã‚‹ç”Ÿç”£æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®è²´é‡ãªãƒªã‚½ãƒ¼ã‚¹ã‚’ã€ãƒ«ãƒ¼ãƒãƒ³ãƒ¯ãƒ¼ã‚¯ã‚„ä»–äººã®è¦æœ›ï¼ˆãƒ¡ãƒ¼ãƒ«è¿”ä¿¡ï¼‰ã§æ¶ˆè²»ã™ã‚‹ã®ã¯æœ€å¤§ã®æµªè²»ã§ã™ã€‚"
                },
                {
                    "name": "é›†ä¸­åŠ›ã‚’åŸºæº–ã«ã—ãŸä½œæ¥­åˆ†é¡",
                    "how_to": "ã‚¿ã‚¹ã‚¯ã‚’ã€Œé«˜é›†ä¸­ï¼ˆæ€è€ƒï¼‰ã€ã€Œä¸­é›†ä¸­ï¼ˆä¼šè­°ãƒ»èª¿æ•´ï¼‰ã€ã€Œä½é›†ä¸­ï¼ˆä½œæ¥­ï¼‰ã€ã«åˆ†é¡ã—ã€è‡ªåˆ†ã®ãƒã‚¤ã‚ªãƒªã‚ºãƒ ã«åˆã‚ã›ã¦é…ç½®ã—ã¾ã™ï¼ˆä¾‹ï¼šåˆå‰ã¯é«˜é›†ä¸­ã€åˆå¾Œã¯ä¸­é›†ä¸­ã€å¤•æ–¹ã¯ä½é›†ä¸­ï¼‰ã€‚",
                    "tips": "æ°—åˆã§é›†ä¸­ã—ã‚ˆã†ã¨ã™ã‚‹ã®ã§ã¯ãªãã€æ³¢ã«ä¹—ã‚‹ã‚ˆã†ã«ã‚¿ã‚¹ã‚¯ã‚’ã“ãªã—ã¾ã™ã€‚é›†ä¸­åŠ›ãŒè½ã¡ã¦ããŸã‚‰ç„¡ç†ã«ç²˜ã‚‰ãšã€ä½é›†ä¸­ã‚¿ã‚¹ã‚¯ï¼ˆçµŒè²»ç²¾ç®—ãªã©ï¼‰ã«åˆ‡ã‚Šæ›¿ãˆã‚‹æ–¹ãŒåŠ¹ç‡çš„ã§ã™ã€‚"
                }
            ]
        })

    # 5. æƒ³èµ·ã®èª¤ã‚ŠãŒå¤§ãã„ (Large Recall Error)
    if s_rec_acc <= 12:
        recommendations.append({
            "title": "Strategy: Calibration (è¦‹ç©ã‚‚ã‚Šã®è£œæ­£)",
            "reason": "éå»ã®çµŒé¨“ã‹ã‚‰æ™‚é–“ã‚’æ­£ã—ãè¦‹ç©ã‚‚ã‚Œã¦ãŠã‚‰ãšã€ã€Œè¨ˆç”»éŒ¯èª¤ï¼ˆæ¥½è¦³çš„ãªè¦‹ç©ã‚‚ã‚Šï¼‰ã€ã«é™¥ã‚Šã‚„ã™ã„å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚è‡ªåˆ†ã®ã€Œæ„Ÿè¦šã€ã‚’ä¿¡ç”¨ã›ãšã€å®¢è¦³çš„ãªã€Œæ•°å­—ã€ã‚„ã€Œä»•çµ„ã¿ã€ã§è£œæ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚",
            "methods": [
                {
                    "name": "1.5å€ãƒ«ãƒ¼ãƒ«ï¼ˆãƒãƒƒãƒ•ã‚¡ã®å¼·åˆ¶ï¼‰",
                    "how_to": "è¦‹ç©ã‚‚ã‚Šã‚’å‡ºã™éš›ã€è‡ªåˆ†ãŒã€Œã“ã‚Œãã‚‰ã„ã§çµ‚ã‚ã‚‹ã€ã¨ç›´æ„Ÿã—ãŸæ™‚é–“ã‚’1.5å€ã€œ2å€ã«ã—ã¦ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’çµ„ã‚“ã§ãã ã•ã„ã€‚1æ™‚é–“ã§çµ‚ã‚ã‚‹ã¨æ€ã£ãŸã‚‰ã€1æ™‚é–“åŠç¢ºä¿ã—ã¾ã™ã€‚",
                    "tips": "äººé–“ã«ã¯ã€Œãƒˆãƒ©ãƒ–ãƒ«ãªãã‚¹ãƒ ãƒ¼ã‚ºã«ã„ã£ãŸå ´åˆã®æœ€çŸ­æ™‚é–“ã€ã‚’è¦‹ç©ã‚‚ã£ã¦ã—ã¾ã†æœ¬èƒ½çš„ãªãƒã‚¤ã‚¢ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚1.5å€ã«ã—ã¦ã‚ˆã†ã‚„ãã€Œç¾å®Ÿçš„ãªãƒ©ã‚¤ãƒ³ã€ã«ãªã‚‹ã¨å¿ƒå¾—ã¦ãã ã•ã„ã€‚ä½™ã£ãŸã‚‰ä»–ã®ã“ã¨ã‚’ã™ã‚Œã°è‰¯ã„ã ã‘ã§ã™ã€‚"
                },
                {
                    "name": "1440åˆ†æ„è­˜",
                    "how_to": "1æ—¥ã‚’ã€Œ24æ™‚é–“ã€ã§ã¯ãªãã€Œ1440åˆ†ã€ã¨ã—ã¦æ‰ãˆã€æ™‚è¨ˆã®è¡¨ç¤ºã‚’åˆ†å˜ä½ã«ã™ã‚‹ã‹ã€å¸¸ã«ã€Œã‚ã¨ä½•åˆ†ã‚ã‚‹ã‹ã€ã‚’æ„è­˜ã—ã¦ãã ã•ã„ã€‚",
                    "tips": "ã€Œæ™‚é–“ã€ã¨ã„ã†å˜ä½ã¯å¤§é›‘æŠŠã™ãã¦ã€ç„¡é§„é£ã„ã«æ°—ã¥ãã«ãã„ã§ã™ã€‚ã€Œåˆ†ã€å˜ä½ã§æ‰ãˆã‚‹ã“ã¨ã§ã€10åˆ†ã‚„15åˆ†ã®ã‚¹ã‚­ãƒæ™‚é–“ã®ä¾¡å€¤ãŒä¸ŠãŒã‚Šã€è¦‹ç©ã‚‚ã‚Šã®è§£åƒåº¦ãŒé«˜ã¾ã‚Šã¾ã™ã€‚"
                },
                {
                    "name": "æ™‚è¨ˆç¢ºèª20å›",
                    "how_to": "ãƒ‡ã‚¹ã‚¯ã«ã‚¢ãƒŠãƒ­ã‚°æ™‚è¨ˆã‚’ç½®ãã€1æ—¥ã«20å›ä»¥ä¸Šã€æ„è­˜çš„ã«æ™‚è¨ˆã‚’è¦‹ã¦ãã ã•ã„ã€‚ã€Œä»Šã®ä½œæ¥­ã«ä½•åˆ†ã‹ã‹ã£ãŸã‹ã€ã‚’å¸¸ã«ç­”ãˆåˆã‚ã›ã—ã¾ã™ã€‚",
                    "tips": "ãƒˆãƒƒãƒ—5%ç¤¾å“¡ã®å®Ÿè·µç¿’æ…£ã§ã™ã€‚è‡ªåˆ†ã®ã€Œä½“æ„Ÿæ™‚é–“ã€ã¨ã€Œå®Ÿæ™‚é–“ã€ã®ã‚ºãƒ¬ã‚’éƒ½åº¦ä¿®æ­£ã™ã‚‹ã“ã¨ã§ã€è„³å†…ã®ä½“å†…æ™‚è¨ˆã‚’ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã—ã€è¦‹ç©ã‚‚ã‚Šèƒ½åŠ›ã‚’ç‰©ç†çš„ã«å‘ä¸Šã•ã›ã¾ã™ã€‚"
                }
            ]
        })

    # 6. æƒ³èµ·ã®èª¤ã‚ŠãŒå°ã•ã„ (Small Recall Error)
    if s_rec_acc >= 13:
        recommendations.append({
            "title": "Strategy: Advanced Optimization (é«˜ç²¾åº¦ãªæœ€é©åŒ–)",
            "reason": "æ™‚é–“ã®è¦‹ç©ã‚‚ã‚ŠãŒæ­£ç¢ºã§ã€ç¾å®Ÿçš„ãªè¨ˆç”»èƒ½åŠ›ã‚’ãŠæŒã¡ã§ã™ã€‚ãƒã‚¤ãƒŠã‚¹ã‚’ã‚¼ãƒ­ã«ã™ã‚‹æ®µéšã¯éãã¦ã„ã¾ã™ã€‚ã“ã“ã‹ã‚‰ã¯ã€ã•ã‚‰ã«è„³ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å¼•ãå‡ºã—ã€æŠ•è³‡å¯¾åŠ¹æœã‚’é«˜ã‚ã‚‹ãƒ•ã‚§ãƒ¼ã‚ºã§ã™ã€‚",
            "methods": [
                {
                    "name": "è„³ç•ªåœ°åˆ¥æ™‚é–“é…åˆ†",
                    "how_to": "ã€Œè¦–è¦šç³»ï¼ˆè³‡æ–™ä½œæˆï¼‰ã€ã€Œè¨˜æ†¶ç³»ï¼ˆå­¦ç¿’ï¼‰ã€ã€Œé‹å‹•ç³»ï¼ˆç§»å‹•ãƒ»è¨ªå•ï¼‰ã€ã€Œè´è¦šç³»ï¼ˆéŸ³å£°å­¦ç¿’ï¼‰ã€ãªã©ã€ä½¿ã†è„³ã®éƒ¨ä½ã‚’ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã•ã›ãªãŒã‚‰ã‚¿ã‚¹ã‚¯ã‚’çµ„ã‚“ã§ãã ã•ã„ã€‚",
                    "tips": "åŒã˜è„³ç•ªåœ°ã‚’ä½¿ã„ç¶šã‘ã‚‹ã¨ç‰¹å®šã®ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã ã‘ãŒç–²åŠ´ã—ã¾ã™ã€‚ç­‹ãƒˆãƒ¬ã§é›ãˆã‚‹éƒ¨ä½ã‚’å¤‰ãˆã‚‹ã‚ˆã†ã«ã€ä½¿ã†è„³ã®éƒ¨ä½ã‚’å¤‰ãˆã‚‹ã“ã¨ã§ã€ä¼‘æ†©ãªã—ã§ã‚‚é«˜ã„é›†ä¸­åŠ›ã‚’æŒç¶šã•ã›ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚"
                },
                {
                    "name": "æ™‚é–“æŠ•è³‡æ€è€ƒï¼ˆROIè¨ˆç®—ï¼‰",
                    "how_to": "æ™‚é–“ã®ä½¿ã„é“ã‚’ã€Œæ¶ˆè²»ï¼ˆç”Ÿæ´»ã«å¿…è¦ï¼‰ã€ã€Œæµªè²»ï¼ˆç„¡æ„å‘³ï¼‰ã€ã€ŒæŠ•è³‡ï¼ˆå°†æ¥ã®ãƒªã‚¿ãƒ¼ãƒ³ï¼‰ã€ã«åˆ†é¡ã—ã€æµªè²»ã‚’å‰Šã£ã¦æŠ•è³‡ã«å›ã™æ¯”ç‡ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚",
                    "tips": "æ­£ç¢ºãªæ™‚é–“æŠŠæ¡èƒ½åŠ›ãŒã‚ã‚‹ã‚ãªãŸãªã‚‰ã€ç²¾å¯†ãªROIè¨ˆç®—ãŒå¯èƒ½ã§ã™ã€‚ã€Œã“ã®1æ™‚é–“ã®ä½œæ¥­ã¯ã€å°†æ¥ã©ã‚Œãã‚‰ã„ã®ä¾¡å€¤ã‚’ç”Ÿã‚€ã‹ï¼Ÿã€ã‚’æŠ•è³‡å®¶è¦–ç‚¹ã§ã‚·ãƒ“ã‚¢ã«å•ã„ç¶šã‘ã¦ãã ã•ã„ã€‚"
                }
            ]
        })

    # 7. æƒ³èµ·ãŒè‚¯å®šçš„ã™ãã‚‹ (Too Positive)
    if s_rec_pos >= 13 and s_rec_acc <= 12: 
        recommendations.append({
            "title": "Strategy: Reality Check (ç¾å®Ÿçš„ãªãƒªã‚¹ã‚¯è©•ä¾¡)",
            "reason": "ã€Œãªã‚“ã¨ã‹ãªã‚‹ã€ã€Œè‡ªåˆ†ã¯ã§ãã‚‹ã€ã¨ã„ã†æ ¹æ‹ ã®ãªã„è‡ªä¿¡ï¼ˆæ¥½è¦³ãƒã‚¤ã‚¢ã‚¹ï¼‰ãŒå¼·ãã€ãƒªã‚¹ã‚¯ã‚’è¦‹è½ã¨ã—ã¦è¨ˆç”»å€’ã‚Œã‚’ç¹°ã‚Šè¿”ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒã‚¸ãƒ†ã‚£ãƒ–ã•ã¯æ­¦å™¨ã§ã™ãŒã€è¨ˆç”»æ®µéšã§ã¯ã€Œå†·é™ãªä»–äººã€ã®è¦–ç‚¹ãŒå¿…è¦ã§ã™ã€‚",
            "methods": [
                {
                    "name": "ä»£æ›¿è¡Œå‹•ã®è¨˜éŒ²ã¨æ’é™¤",
                    "how_to": "è¨ˆç”»ãŒå´©ã‚ŒãŸéš›ã€å®Ÿéš›ã«ä½•ã‚’ã—ã¦ã„ãŸã‹ï¼ˆã‚¹ãƒãƒ›ã€é›‘è«‡ã€é•·ã™ãã‚‹ä¼‘æ†©ï¼‰ã‚’æ­£ç›´ã«è¨˜éŒ²ã—ã€ãã®èª˜æƒ‘ã‚’ç‰©ç†çš„ã«é®æ–­ï¼ˆã‚¢ãƒ—ãƒªå‰Šé™¤ã€å ´æ‰€ç§»å‹•ï¼‰ã—ã¦ãã ã•ã„ã€‚",
                    "tips": "ã€Œæ„å¿—ã®åŠ›ã€ã§èª˜æƒ‘ã«å‹ã¨ã†ã¨ã—ãªã„ã§ãã ã•ã„ã€‚ã‚ãªãŸã¯è‡ªåˆ†ãŒæ€ã£ã¦ã„ã‚‹ã»ã©æ„å¿—ãŒå¼·ãã‚ã‚Šã¾ã›ã‚“ã€‚ç’°å¢ƒã‚’å¤‰ãˆã‚‹ã“ã¨ã§ã—ã‹ã€ã“ã®ç„¡æ„è­˜ã®è¡Œå‹•ã¯é˜²ã’ã¾ã›ã‚“ã€‚"
                },
                {
                    "name": "é€±æ¬¡æŒ¯ã‚Šè¿”ã‚Šã‚·ã‚¹ãƒ†ãƒ ï¼ˆFact Baseï¼‰",
                    "how_to": "é€±æœ«ã«30åˆ†ã€ã€Œé”æˆã§ããŸã“ã¨ã€ã ã‘ã§ãªãã€Œé”æˆã§ããªã‹ã£ãŸã“ã¨ã¨ãã®åŸå› ã€ã‚’äº‹å®Ÿãƒ™ãƒ¼ã‚¹ã§æ›¸ãå‡ºã—ã¦ãã ã•ã„ã€‚",
                    "tips": "ã‚ãªãŸã®è„³ã¯ã€éƒ½åˆã®æ‚ªã„è¨˜æ†¶ã‚’æ¶ˆå»ã¾ãŸã¯æ”¹ç«„ã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚è¨˜éŒ²ã«æ®‹ã—ã€æ–‡å­—ã¨ã—ã¦ç›´è¦–ã™ã‚‹ã“ã¨ã§ã€æ¥½è¦³çš„ãªè¨˜æ†¶ã‚’ç¾å®Ÿã«å¼•ãæˆ»ã—ã€å­¦ç¿’ã‚µã‚¤ã‚¯ãƒ«ã‚’å›ã—ã¾ã™ã€‚"
                }
            ]
        })

    # 8. æƒ³èµ·ãŒå¦å®šçš„ã™ãã‚‹ (Too Negative)
    if s_rec_pos <= 12:
        recommendations.append({
            "title": "Strategy: Self-Efficacy Boost (è‡ªå·±åŠ¹åŠ›æ„Ÿã®å‘ä¸Š)",
            "reason": "éå»ã®å¤±æ•—ã«ã¨ã‚‰ã‚ã‚Œã€ã€Œè‡ªåˆ†ã«ã¯ç„¡ç†ã ã€ã€Œã©ã†ã›å¤±æ•—ã™ã‚‹ã€ã¨éåº¦ã«æ…é‡ã«ãªã‚Šã€æŒ‘æˆ¦ã‚’é¿ã‘ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚å¿…è¦ãªã®ã¯èƒ½åŠ›å‘ä¸Šã§ã¯ãªãã€è„³ã«æŸ“ã¿ä»˜ã„ãŸã€Œã§ããªã„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã€ã®è§£é™¤ã§ã™ã€‚",
            "methods": [
                {
                    "name": "åˆå‹•ã®é€Ÿã•ï¼ˆ5åˆ†ãƒ«ãƒ¼ãƒ«ï¼‰",
                    "how_to": "æ°—ãŒé€²ã¾ãªã„ã‚¿ã‚¹ã‚¯ã€è‡ªä¿¡ãŒãªã„ã‚¿ã‚¹ã‚¯ã‚‚ã€ã¾ãšã€Œ5åˆ†ã ã‘ã€æ‰‹ã‚’ã¤ã‘ã¦ãã ã•ã„ã€‚5åˆ†ã‚„ã£ã¦ç„¡ç†ãªã‚‰ã‚„ã‚ã¦ã‚‚ã„ã„ã€ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã§ç€æ‰‹ã—ã¾ã™ã€‚",
                    "tips": "ã‚„ã‚‹æ°—ã¯å¾…ã£ã¦ã„ã¦ã‚‚æ¹§ã„ã¦ãã¾ã›ã‚“ã€‚ã‚„ã‚Šå§‹ã‚ã‚‹ã“ã¨ã§è„³ã®å´åæ ¸ãŒåˆºæ¿€ã•ã‚Œã€å¾Œã‹ã‚‰ã‚„ã‚‹æ°—ï¼ˆä½œæ¥­èˆˆå¥®ï¼‰ãŒå‡ºã¦ãã¾ã™ã€‚ãƒˆãƒƒãƒ—ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ¼ã¯åˆå‹•ãŒåœ§å€’çš„ã«é€Ÿã„ã®ãŒç‰¹å¾´ã§ã™ã€‚"
                },
                {
                    "name": "15åˆ†ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã¨ãƒã‚¤ã‚¯ãƒ­ã‚µã‚¯ã‚»ã‚¹",
                    "how_to": "ã‚¿ã‚¹ã‚¯ã‚’15åˆ†å˜ä½ã¾ã§ç´°ã‹ãåˆ†è§£ã—ã€æ¬¡ã€…ã¨å®Œäº†ã•ã›ã¦æ¶ˆã—è¾¼ã‚“ã§ãã ã•ã„ã€‚ã¾ãŸã€ä¸€æ—¥ã®çµ‚ã‚ã‚Šã«ã€Œã§ããŸã“ã¨ã€ã‚’3ã¤æ›¸ãå‡ºã—ã¾ã™ã€‚",
                    "tips": "å¤§ããªå±±ã‚’ç™»ã‚ã†ã¨ã™ã‚‹ã¨è¶³ãŒã™ãã¿ã¾ã™ã€‚ç›®ã®å‰ã®å°çŸ³ã‚’æ‹¾ã†ã“ã¨ã«é›†ä¸­ã—ã¦ãã ã•ã„ã€‚ã€Œå®Œäº†ã•ã›ãŸã€ã¨ã„ã†äº‹å®Ÿã®ç©ã¿é‡ã­ã ã‘ãŒã€å¤±ã‚ã‚ŒãŸè‡ªä¿¡ã‚’å›å¾©ã•ã›ã¾ã™ã€‚"
                },
                {
                    "name": "æœã®ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°ã‚»ãƒ©ãƒ”ãƒ¼ï¼ˆã‚¸ãƒ£ãƒ¼ãƒŠãƒªãƒ³ã‚°ï¼‰",
                    "how_to": "æœä¸€ç•ªã«ã€é ­ã«æµ®ã‹ã¶ä¸å®‰ã€ææ€–ã€ãƒã‚¬ãƒ†ã‚£ãƒ–ãªæ„Ÿæƒ…ã‚’ã€ã‚ã‚Šã®ã¾ã¾ç´™ã«æ›¸ãæ®´ã£ã¦ãã ã•ã„ã€‚æ™‚é–“ã¯3åˆ†ã€œ5åˆ†ã§æ§‹ã„ã¾ã›ã‚“ã€‚",
                    "tips": "ä¸å®‰ã¯è„³å†…ã®ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªã‚’å æ‹ ã—ã€IQã‚’ä½ä¸‹ã•ã›ã¾ã™ã€‚ç´™ã«æ›¸ãå‡ºã™ã“ã¨ã§ä¸å®‰ã‚’ã€Œå¤–éƒ¨åŒ–ã€ã—ã€è„³ã®ãƒ¡ãƒ¢ãƒªã‚’è§£æ”¾ã™ã‚‹ã“ã¨ã§ã€å†·é™ãªåˆ¤æ–­åŠ›ã‚’å–ã‚Šæˆ»ã›ã¾ã™ã€‚"
                }
            ]
        })

    # çµæœè¡¨ç¤ºãƒ«ãƒ¼ãƒ—
    if not recommendations:
        st.success("Balance is optimal. ç¾åœ¨ã®æ™‚é–“æ„Ÿè¦šãƒãƒ©ãƒ³ã‚¹ã¯éå¸¸ã«è‰¯å¥½ã§ã™ã€‚")
    else:
        for rec in recommendations:
            with st.expander(f"{rec['title']}", expanded=True):
                st.info(f"ğŸ’¡ **Why This Works (èªçŸ¥ç§‘å­¦çš„æ ¹æ‹ ):** \n{rec['reason']}")
                for method in rec['methods']:
                    st.markdown("---")
                    st.markdown(f"#### ğŸ›  {method['name']}")
                    st.markdown(f"**How-To:** {method['how_to']}")
                    st.markdown(f"**Tips:** {method['tips']}")
                    st.markdown(f"<div class='book-ref'>å‡ºå…¸: {method['source']}</div>", unsafe_allow_html=True)

    st.markdown("---")
    st.caption("Developed for Dirbato Co., Ltd.")
